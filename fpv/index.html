<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
  <title>赛事报名｜Flyz远征飞</title>
  <link rel="icon" href="/favicon.ico" type="image/x-icon">
  <!-- 国内CDN依赖 -->
  <script src="https://cdn.bootcdn.net/ajax/libs/jquery/3.7.1/jquery.min.js"></script>
  <script src="https://cdn.bootcdn.net/ajax/libs/echarts/5.4.3/echarts.min.js"></script>
  <script src="https://cdn.bootcdn.net/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
  <style>
    /* 全局样式重置 */
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    :root {
      /* 科技蓝标准配色 */
      --tech-blue: #0096FF;
      --tech-dark: #0066CC;
      --tech-light: #66CCFF;
      --tech-gray: #F0F7FF;
      --text-main: #333333;
      --text-light: #FFFFFF;
      --shadow: 0 4px 20px rgba(0, 150, 255, 0.15);
      --radius: 12px;
    }

    /* ========== 通用科技感蓝色方格背景 ========== */
    body {
      font-family: system-ui, -apple-system, sans-serif;
      background-color: #000814;
      /* 标准科技方格背景 - 深色底+蓝色线条 */
      background-image: 
        linear-gradient(rgba(0, 150, 255, 0.1) 1px, transparent 1px),
        linear-gradient(90deg, rgba(0, 150, 255, 0.1) 1px, transparent 1px);
      background-size: 30px 30px;
      color: var(--text-main);
      min-height: 100vh;
      padding: 20px 0;
    }

    /* 页面容器 - 居中+留白 */
    .page-container {
      max-width: 1200px;
      margin: 0 auto;
      padding: 0 20px;
    }

    /* ========== 左上角炫酷Logo组合 ========== */
    .header-logo {
      display: flex;
      align-items: center;
      margin-bottom: 20px;
      position: relative;
      z-index: 10;
    }

    .logo-img {
      width: 60px;
      height: 60px;
      border-radius: 10px;
      box-shadow: 0 0 20px var(--tech-light);
      transition: all 0.3s ease;
    }

    .logo-img:hover {
      transform: rotate(5deg) scale(1.1);
      box-shadow: 0 0 30px var(--tech-blue);
    }

    .logo-text-group {
      margin-left: 15px;
    }

    .logo-domain {
      font-size: 1.5rem;
      color: var(--tech-blue);
      font-weight: bold;
      text-shadow: 0 0 15px var(--tech-light);
      letter-spacing: 1px;
      background: linear-gradient(90deg, var(--tech-light), var(--tech-blue));
      -webkit-background-clip: text;
      background-clip: text;
      color: transparent;
      animation: logoGlow 3s ease-in-out infinite;
    }

    @keyframes logoGlow {
      0%, 100% { background-position: 0% 50%; }
      50% { background-position: 100% 50%; }
    }

    .logo-slogan {
      font-size: 1rem;
      color: var(--tech-light);
      margin-top: 3px;
      text-shadow: 0 0 10px rgba(0, 150, 255, 0.3);
      animation: sloganBreath 4s ease-in-out infinite;
    }

    @keyframes sloganBreath {
      0%, 100% { opacity: 0.8; }
      50% { opacity: 1; }
    }

    /* 页面标题 - 发光特效 */
    .page-title {
      text-align: center;
      font-size: 3rem;
      color: var(--text-light);
      margin: 10px 0 40px;
      text-shadow: 0 0 25px var(--tech-light);
      letter-spacing: 3px;
      position: relative;
    }

    .page-title::after {
      content: '';
      display: block;
      width: 120px;
      height: 4px;
      background: linear-gradient(90deg, transparent, var(--tech-blue), transparent);
      margin: 15px auto 0;
      border-radius: 2px;
    }

    /* 标签切换栏 - 科技感按钮 */
    .tab-nav {
      display: flex;
      justify-content: center;
      gap: 20px;
      margin-bottom: 40px;
      flex-wrap: wrap;
    }

    .tab-btn {
      padding: 14px 40px;
      background-color: rgba(255, 255, 255, 0.05);
      border: 2px solid var(--tech-blue);
      border-radius: 50px;
      font-size: 1.2rem;
      color: var(--text-light);
      cursor: pointer;
      transition: all 0.4s ease;
      backdrop-filter: blur(10px);
      position: relative;
      overflow: hidden;
    }

    .tab-btn::before {
      content: '';
      position: absolute;
      top: 0;
      left: -100%;
      width: 100%;
      height: 100%;
      background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.1), transparent);
      transition: left 0.6s ease;
    }

    .tab-btn.active {
      background-color: var(--tech-blue);
      box-shadow: 0 0 30px var(--tech-light);
    }

    .tab-btn:hover:not(.active) {
      transform: translateY(-3px);
      border-color: var(--tech-light);
      box-shadow: 0 0 20px rgba(102, 204, 255, 0.4);
    }

    .tab-btn:hover::before {
      left: 100%;
    }

    /* 内容卡片 - 玻璃拟态+边框发光 */
    .tab-content {
      display: none;
      background-color: rgba(255, 255, 255, 0.95);
      border-radius: var(--radius);
      padding: 40px;
      box-shadow: var(--shadow);
      margin-bottom: 40px;
      border: 1px solid rgba(0, 150, 255, 0.3);
      position: relative;
      overflow: hidden;
    }

    .tab-content::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 4px;
      background: linear-gradient(90deg, var(--tech-blue), var(--tech-light));
    }

    .tab-content.active {
      display: block;
      animation: fadeInUp 0.6s ease-out;
    }

    @keyframes fadeInUp {
      from {
        opacity: 0;
        transform: translateY(30px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    /* 板块标题 */
    .section-title {
      font-size: 2rem;
      color: var(--tech-dark);
      margin-bottom: 30px;
      text-align: center;
      font-weight: 600;
    }

    .section-title::after {
      content: '';
      display: block;
      width: 60px;
      height: 3px;
      background-color: var(--tech-blue);
      margin: 12px auto 0;
      border-radius: 3px;
    }

    /* ========== 赞助商方块云图 ========== */
    #sponsor-cloud {
      width: 100%;
      height: 480px;
      border-radius: var(--radius);
      border: 1px solid var(--tech-light);
      background-color: rgba(255, 255, 255, 0.5);
      transition: all 0.3s ease;
    }

    #sponsor-cloud:hover {
      box-shadow: 0 0 25px rgba(0, 150, 255, 0.2);
    }

    /* ========== 选手表格 - 精细化美化 ========== */
    .player-table {
      width: 100%;
      border-collapse: separate;
      border-spacing: 0;
      border-radius: var(--radius);
      overflow: hidden;
      box-shadow: 0 5px 15px rgba(0, 0, 0, 0.08);
    }

    .player-table th {
      background: linear-gradient(90deg, var(--tech-dark), var(--tech-blue));
      color: var(--text-light);
      padding: 18px;
      font-size: 1.15rem;
      text-align: center;
      letter-spacing: 1px;
    }

    .player-table td {
      padding: 18px;
      text-align: center;
      font-size: 1.05rem;
      border-bottom: 1px solid rgba(0, 150, 255, 0.1);
    }

    .player-table tr:last-child td {
      border-bottom: none;
    }

    .player-table tr:hover {
      background-color: var(--tech-gray);
      transition: background-color 0.3s ease;
    }

    /* 报名按钮 - 渐变+发光 */
    .apply-btn {
      display: block;
      width: fit-content;
      margin: 40px auto 0;
      padding: 16px 50px;
      background: linear-gradient(90deg, var(--tech-dark), var(--tech-blue));
      color: var(--text-light);
      border: none;
      border-radius: 50px;
      font-size: 1.3rem;
      cursor: pointer;
      transition: all 0.4s ease;
      box-shadow: 0 5px 20px rgba(0, 150, 255, 0.3);
      position: relative;
      overflow: hidden;
    }

    .apply-btn::before {
      content: '';
      position: absolute;
      top: 0;
      left: -100%;
      width: 100%;
      height: 100%;
      background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
      transition: left 0.6s ease;
    }

    .apply-btn:hover {
      transform: translateY(-3px);
      box-shadow: 0 8px 25px rgba(0, 150, 255, 0.4);
    }

    .apply-btn:hover::before {
      left: 100%;
    }

    /* ========== 弹窗样式 - 科技感玻璃拟态 ========== */
    .modal {
      position: fixed;
      top: 0;
      left: 0;
      width: 100vw;
      height: 100vh;
      background-color: rgba(0, 8, 20, 0.85);
      backdrop-filter: blur(10px);
      z-index: 1000;
      display: none;
      align-items: center;
      justify-content: center;
      padding: 20px;
    }

    .modal.show {
      display: flex;
      animation: modalFade 0.4s ease;
    }

    @keyframes modalFade {
      from { opacity: 0; }
      to { opacity: 1; }
    }

    .modal-content {
      background-color: rgba(255, 255, 255, 0.98);
      border-radius: var(--radius);
      padding: 40px;
      width: 100%;
      max-width: 580px;
      box-shadow: 0 10px 40px rgba(0, 150, 255, 0.25);
      border: 1px solid var(--tech-light);
      position: relative;
    }

    .modal-content::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 3px;
      background: linear-gradient(90deg, var(--tech-blue), var(--tech-light));
    }

    .modal-title {
      font-size: 1.9rem;
      color: var(--tech-dark);
      margin-bottom: 25px;
      text-align: center;
    }

    .modal-text {
      font-size: 1.15rem;
      line-height: 1.8;
      margin-bottom: 30px;
      text-align: center;
      color: #555;
    }

    .modal-wechat {
      font-size: 1.7rem;
      color: var(--tech-blue);
      font-weight: bold;
      text-align: center;
      margin: 25px 0;
      letter-spacing: 2px;
      text-shadow: 0 0 10px rgba(0, 150, 255, 0.2);
    }

    /* ========== 赞助商表单 - 精细化设计 ========== */
    .sponsor-form {
      display: flex;
      flex-direction: column;
      gap: 22px;
      margin-bottom: 30px;
    }

    .form-group {
      position: relative;
    }

    .form-group label {
      position: absolute;
      top: -10px;
      left: 20px;
      background-color: #fff;
      padding: 0 10px;
      font-size: 0.95rem;
      color: var(--tech-dark);
      font-weight: 500;
    }

    .form-group label .required {
      color: #ff4d4f;
      margin-left: 3px;
    }

    .form-group input, .form-group select {
      width: 100%;
      padding: 16px 20px;
      border: 2px solid rgba(0, 150, 255, 0.2);
      border-radius: var(--radius);
      font-size: 1.1rem;
      background-color: #fff;
      transition: all 0.3s ease;
    }

    .form-group input:focus, .form-group select:focus {
      outline: none;
      border-color: var(--tech-blue);
      box-shadow: 0 0 15px rgba(0, 150, 255, 0.15);
    }

    .form-submit {
      padding: 15px;
      background: linear-gradient(90deg, var(--tech-dark), var(--tech-blue));
      color: var(--text-light);
      border: none;
      border-radius: var(--radius);
      font-size: 1.2rem;
      cursor: pointer;
      transition: all 0.3s ease;
    }

    .form-submit:hover {
      box-shadow: 0 5px 15px rgba(0, 150, 255, 0.3);
    }

    .close-btn {
      padding: 12px 35px;
      background-color: #f8f9fa;
      color: #555;
      border: 1px solid #e9ecef;
      border-radius: var(--radius);
      font-size: 1.05rem;
      cursor: pointer;
      display: block;
      margin: 0 auto;
      transition: all 0.3s ease;
    }

    .close-btn:hover {
      background-color: var(--tech-gray);
      border-color: var(--tech-light);
    }

    /* 海报生成隐藏容器 */
    #poster-container {
      position: fixed;
      top: -9999px;
      left: -9999px;
      background-color: #fff;
      width: 500px;
      height: 600px;
      padding: 40px;
      border-radius: var(--radius);
      border: 3px solid var(--tech-blue);
      box-shadow: 0 10px 30px rgba(0, 150, 255, 0.2);
    }

    /* 响应式适配 - 小屏幕Logo缩小 */
    @media (max-width: 768px) {
      .logo-img {
        width: 50px;
        height: 50px;
      }
      .logo-domain {
        font-size: 1.2rem;
      }
      .logo-slogan {
        font-size: 0.9rem;
      }
      .page-title {
        font-size: 2.2rem;
      }
    }
  </style>
</head>
<body>
  <div class="page-container">
    <!-- 左上角炫酷Logo组合 -->
    <div class="header-logo">
      <img src="https://www.img520.com/kqDPsb.png" alt="Flyz远征飞 Logo" class="logo-img">
      <div class="logo-text-group">
        <div class="logo-domain">917813.com.cn</div>
        <div class="logo-slogan">Flyz远征飞｜为方便模友而生</div>
      </div>
    </div>

    <h1 class="page-title">Flyz远征飞2026全国线上FPV赛事报名中心</h1>

    <!-- 标签切换 -->
    <div class="tab-nav">
      <button class="tab-btn active" data-tab="sponsor-tab">赞助商专区</button>
      <button class="tab-btn" data-tab="player-tab">选手报名区</button>
    </div>

    <!-- 赞助商专区 -->
    <div class="tab-content active" id="sponsor-tab">
      <h2 class="section-title">当前赞助商</h2>
      <div id="sponsor-cloud"></div>
      <button class="apply-btn" id="sponsor-apply">赞助商报名</button>
    </div>

    <!-- 选手报名区 -->
    <div class="tab-content" id="player-tab">
      <h2 class="section-title">参赛选手名单</h2>
      <table class="player-table">
        <thead>
          <tr>
            <<th width="30%">选手ID</</th>
            <<th width="70%">选手姓名</</th>
          </tr>
        </thead>
        <tbody id="player-list">
          <!-- JS 动态填充 -->
        </tbody>
      </table>
      <button class="apply-btn" id="player-apply">选手报名</button>
    </div>
  </div>

  <!-- 选手报名弹窗 -->
  <div class="modal" id="player-modal">
    <div class="modal-content">
      <h3 class="modal-title">选手报名须知</h3>
      <p class="modal-text">请添加下方微信ID，发送【选手报名】<br>我会拉你进群 在群也请加我发报名昵称 </p>
      <p class="modal-wechat">YGWFK2024</p>
      <button class="close-btn" onclick="closeModal('player-modal')">关闭</button>
    </div>
  </div>

  <!-- 赞助商报名弹窗 -->
  <div class="modal" id="sponsor-modal">
    <div class="modal-content">
      <h3 class="modal-title">赞助商信息提交</h3>
      <form class="sponsor-form" id="sponsor-form">
        <div class="form-group">
          <label>赞助商名称 <span class="required">*</span></label>
          <input type="text" name="name" placeholder="请填写企业/个人名称" required>
        </div>
        <div class="form-group">
          <label>微信号 <span class="required">*</span></label>
          <input type="text" name="wechat" placeholder="请填写常用微信号" required>
        </div>
        <div class="form-group">
          <label>手机号</label>
          <input type="tel" name="phone" placeholder="选填，方便紧急联系">
        </div>
        <div class="form-group">
          <label>赞助类型 <span class="required">*</span></label>
          <select name="type" required>
            <option value="">请选择赞助类型</option>
            <option value="资金赞助">资金赞助（2元起赞助）</option>
            <option value="设备赞助">设备赞助（航模配件等）</option>
            <option value="物料赞助">物料赞助（除航模配件外）</option>
            <option value="场地赞助">技术支持（剪辑组织等）</option>
            <option value="其他赞助">其他赞助</option>
          </select>
        </div>
        <button type="button" class="form-submit" onclick="generatePoster()">保存并生成赞助海报</button>
      </form>
      <button class="close-btn" onclick="closeModal('sponsor-modal')">关闭</button>
    </div>
  </div>

  <!-- 提交成功弹窗 -->
  <div class="modal" id="success-modal">
    <div class="modal-content">
      <h3 class="modal-title">提交成功！</h3>
      <p class="modal-text">请将生成的赞助海报截图<br>发送至下方微信，完成赞助对接</p>
      <p class="modal-wechat">YGWFK2024</p>
      <button class="close-btn" onclick="closeModal('success-modal')">关闭</button>
    </div>
  </div>

  <!-- 海报生成隐藏容器 -->
  <div id="poster-container"></div>

  <script>
    // 1. 标签切换功能
    $(document).ready(function() {
      $('.tab-btn').click(function() {
        const tabId = $(this).attr('data-tab');
        $('.tab-btn').removeClass('active');
        $(this).addClass('active');
        $('.tab-content').removeClass('active');
        $('#' + tabId).addClass('active');
      });

      // 2. 读取赞助商名单 - 生成方块矩阵云图
      $.get('/fpv/zanzhu.txt', function(data) {
        const sponsorList = data.split('\n').filter(item => item.trim() !== '');
        const myChart = echarts.init(document.getElementById('sponsor-cloud'));
        
        // 标准科技方块云图配置
        const option = {
          grid: {
            left: '8%',
            right: '8%',
            top: '12%',
            bottom: '12%'
          },
          series: [{
            type: 'wordCloud',
            gridSize: 20,, // 方格间距，更规整
            sizeRange: [22, 48], // 文字大小区间
            rotationRange: [0, 0], // 纯方块无旋转
            shape: 'square', // 方形布局
            textStyle: {
              fontFamily: 'system-ui',
              fontWeight: 'bold',
              color: function() {
                // 限定科技蓝系配色
                const colors = ['#0066CC', '#0096FF', '#33CCFF', '#66CCFF'];
                return colors[Math.floor(Math.random() * colors.length)];
              }
            },
            emphasis: {
              textStyle: {
                shadowBlur: 15,
                shadowColor: '#0096FF'
              }
            },
            data: sponsorList.map(item => ({
              name: item.trim(),
              value: Math.floor(Math.random() * 45) + 25 // 权重均衡
            }))
          }]
        };

        myChart.setOption(option);
        window.addEventListener('resize', function() {
          myChart.resize();
        });
      }).fail(function() {
        $('#sponsor-cloud').html(`
          <div style="width:100%; height:100%; display:flex; align-items:center; justify-content:center; color:var(--tech-blue); font-size:1.3rem;">
            赞助商名单文件加载失败，请检查 /fpv/zanzhu.txt 路径
          </div>
        `);
      });

      // 3. 读取选手名单 - 生成带ID表格
      $.get('/fpv/flyer.txt', function(data) {
        const playerList = data.split('\n').filter(item => item.trim() !== '');
        const playerTbody = $('#player-list');
        playerTbody.empty();
        
        playerList.forEach((player, index) => {
          const playerId = 'ID' + (index + 1).toString().padStart(3, '0');
          playerTbody.append(`
            <tr>
              <td>${playerId}</td>
              <td>${player.trim()}</td>
            </tr>
          `);
        });
      }).fail(function() {
        $('#player-list').html(`
          <tr>
            <td colspan="2" style="color:var(--tech-blue); font-size:1.2rem; padding:40px;">
              选手名单文件加载失败，请检查 /fpv/flyer.txt 路径
            </td>
          </tr>
        `);
      });
    });

    // 4. 报名按钮点击事件
    document.getElementById('player-apply').onclick = function() {
      document.getElementById('player-modal').classList.add('show');
    };
    document.getElementById('sponsor-apply').onclick = function() {
      document.getElementById('sponsor-modal').classList.add('show');
    };

    // 5. 关闭弹窗函数
    function closeModal(modalId) {
      document.getElementById(modalId).classList.remove('show');
    }

    // 6. 生成赞助海报 + 真实截图下载
    function generatePoster() {
      const form = document.getElementById('sponsor-form');
      const name = form.name.value.trim();
      const wechat = form.wechat.value.trim();
      const phone = form.phone.value.trim() || '未填写';
      const type = form.type.value;

      // 表单验证（必填项校验）
      if (!name || !wechat || !type) {
        alert('带 * 的选项为必填项，请填写完整！');
        return;
      }

      // 填充海报内容
      const posterContainer = document.getElementById('poster-container');
      posterContainer.innerHTML = `
        <div style="text-align:center; margin-bottom:30px;">
          <h2 style="color:#0066CC; font-size:1.8rem; margin-bottom:15px;">Flyz远征飞 赞助协议</h2>
          <hr style="border:1px solid #0096FF; margin-bottom:30px;">
        </div>
        <div style="font-size:1.2rem; line-height:2.5; margin-left:30px;">
          <p><strong>赞助商名称：</strong>${name}</p>
          <p><strong>微信号（选填）：</strong>${wechat}</p>
          <p><strong>手机号（必填）：</strong>${phone}</p>
          <p><strong>赞助类型：</strong>${type}</p>
        </div>
        <div style="position:absolute; bottom:40px; width:88%; text-align:center; color:#0096FF; font-size:1rem;">
          提交时间：${new Date().toLocaleString()}
        </div>
      `;

      // html2canvas生成高清截图并自动下载
      html2canvas(posterContainer, { 
        scale: 2, // 2倍高清
        useCORS: true 
      }).then(canvas => {
        const imgUrl = canvas.toDataURL('image/png', 1.0);
        const link = document.createElement('a');
        link.href = imgUrl;
        link.download = `Flyz赞助协议_${name}.png`;
        link.click();

        // 重置表单+弹窗提示
        form.reset();
        closeModal('sponsor-modal');
        document.getElementById('success-modal').classList.add('show');
      });
    }
  </script>
</body>
</html>
